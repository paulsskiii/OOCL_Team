-- EXERCISE 1
-- NUMBER 1
SELECT 
    CONCAT(S.FIRST_NAME, ' ', S.LAST_NAME) AS SENDER_NAME,
    CONCAT(R.FIRST_NAME, ' ', R.LAST_NAME) AS RECIPIENT_NAME,
    CONCAT(COU.FIRST_NAME, ' ', COU.LAST_NAME) AS COURIER_NAME,
    COU.VEHICLE_TYPE
FROM PACKAGES P
JOIN TRANSACTIONS T 
    ON T.PACKAGE_ID = P.PACKAGE_ID
JOIN CUSTOMERS S 
    ON S.CUSTOMER_ID = T.SENDER_ID
JOIN CUSTOMERS R 
    ON R.CUSTOMER_ID = T.RECIPIENT_ID
JOIN COURIERS COU 
    ON COU.COURIER_ID = T.COURIER_ID;
    
    SELECT * FROM TRANSACTIONS;
    
-- NUMBER 2
SELECT * FROM CUSTOMERS C
LEFT JOIN TRANSACTIONS T ON C.CUSTOMER_ID = T.SENDER_ID
WHERE T.SENDER_ID IS NULL;

-- NUMBER 3
-- WITH RECURSIVE TRACKING_EVENTS AS (
    -- Anchor Member (Base Case)
--    SELECT column1, column2
--    FROM TRACKINGEVENTS
--    WHERE ??

--    UNION ALL

-- Recursive Member
--    SELECT t.column1, t.column2
--    FROM another_table t
--    JOIN cte_name ON t.join_condition
--    WHERE recursive_condition
-- )
-- SELECT *
-- FROM cte_name;